name: Daily Work Update

on:
  schedule:
    - cron: "45 16 * * *"   # Runs at 10:30 PM Nepal Time
  workflow_dispatch:        # Allows manual trigger

jobs:
  send-message:
    runs-on: ubuntu-latest
    steps:
      - name: Get Today's Date
        id: date
        run: echo "today=$(date +"%B %d, %Y")" >> $GITHUB_OUTPUT

      - name: Send Slack Message
        run: |
          curl -X POST \
            -H "Authorization: Bearer ${{ secrets.SLACK_BOT_TOKEN }}" \
            -H "Content-Type: application/json" \
            --data "{
              \"channel\": \"C0A3E15TLBB\",
              \"blocks\": [
                {
                  \"type\": \"section\",
                  \"text\": {
                    \"type\": \"mrkdwn\",
                    \"text\": \"<!channel>\\n*Daily Work Updates*  \`$(date +'%B %d, %Y')\`\\nPlease update your work on this thread.\"
                  }
                }
              ]
            }" \
            https://slack.com/api/chat.postMessage
